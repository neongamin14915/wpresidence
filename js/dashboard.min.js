function wpestate_close_stripe_form(){jQuery(".close_stripe_form").on("click",function(){jQuery(".wpestate_stripe_form_wrapper").hide(),jQuery(".wpestate_stripe_form_1").hide()})}function wpestate_enable_stripe_booking_prop(){jQuery(".wpestate_stripe_booking_prop").unbind(),jQuery(".wpestate_stripe_booking_prop").on("click",function(){jQuery(this).parent();var e=ajaxcalls_vars.admin_url+"admin-ajax.php",t=jQuery(this).attr("data-listingid"),a=jQuery(this).attr("data-isfeatured"),r=jQuery(this).attr("data-modalid"),i=jQuery("#"+r);i.appendTo("body"),i.show(),jQuery.ajax({type:"POST",url:e,data:{action:"wpestate_create_payment_intent_stripe",listingid:t,isfeatured:a},success:function(e){jQuery("#"+r+" .wpestate_stripe_form_1").show(),jQuery("#"+r).find("#wpestate_stripe_form_button_sumit").attr("data-secret",e),wpestate_start_stripe(0,r)},error:function(e){}})}),jQuery(".close_stripe_form").on("click",function(){jQuery(".wpestate_stripe_form_wrapper").hide(),jQuery(".wpestate_stripe_form_1").hide()})}function wpestate_start_stripe_booking(){jQuery("#wpestate_stripe_booking").on("click",function(){var e=jQuery(this).attr("data-modalid");jQuery("#"+e).show(),jQuery("#"+e+" .wpestate_stripe_form_1").show(),wpestate_start_stripe(0,e)})}function wpestate_start_pay_via_woo(){jQuery(".woo_pay").on("click",function(){var e,t,a,r,i,s;e=jQuery(this).attr("data-propid"),t=jQuery(this).attr("data-bookid"),a=jQuery(this).attr("data-invoiceid"),i=jQuery(this).attr("data-deposit"),s=0,jQuery(this).hasClass("woo_pay_submit")&&(s=1),r=ajaxcalls_vars.admin_url+"admin-ajax.php",jQuery.ajax({type:"POST",url:r,data:{action:"wpestate_woo_pay",invoiceid:a,propid:e,book_id:t,depozit:i,is_submit:s},success:function(e){!1!==e&&(window.location.href=dashboard_vars.checkout_url)},error:function(e){}})})}function wpestate_message_delete_inbox(){jQuery(".mess_delete").on("click",function(e){var t,a,r;e.stopPropagation(),a=dashboard_vars.admin_url+"admin-ajax.php",r=jQuery(this).parent().parent().parent().parent(),t=r.attr("data-messid"),jQuery(this),jQuery(this).parent().parent().empty().addClass("delete_inaction").html(dashboard_vars.deleting);var i=jQuery("#wpestate_inbox_actions").val();jQuery.ajax({type:"POST",url:a,data:{action:"wpestate_booking_delete_mess",messid:t,security:i},success:function(e){r.parent().remove(),jQuery(".mess_content, .mess_reply_form").hide()},error:function(e){}})})}function wpestate_message_replay_inbox_2(){jQuery(".mess_send_reply_button2").on("click",function(e){var t;e.stopPropagation(),dashboard_vars.admin_url,t=jQuery(this).parent().parent().parent(),jQuery(this),jQuery(".mess_content, .mess_reply_form").hide(),t.find(".mess_content").show(),t.find(".mess_reply_form").show()})}function wpestate_message_replay_inbox(){jQuery(".mess_reply").on("click",function(e){var t,a,r;e.stopPropagation(),a=dashboard_vars.admin_url+"admin-ajax.php",r=jQuery(this).parent().parent().parent(),t=r.attr("data-messid"),jQuery(this),jQuery(".mess_content, .mess_reply_form").hide(),r.find(".mess_content").show(),r.find(".mess_reply_form").show();var i=jQuery("#wpestate_inbox_actions").val();jQuery.ajax({type:"POST",url:a,data:{action:"wpestate_booking_mark_as_read",messid:t,security:i},success:function(e){r.find(".mess_unread").remove()},error:function(e){}})})}function wpestate_mark_message_as_read(){jQuery(".message_header").on("click",function(){var e,t,a;t=dashboard_vars.admin_url+"admin-ajax.php",a=jQuery(this).parent(),e=a.attr("data-messid"),jQuery(this),jQuery(this).parents(".inbox_row").addClass("inbox_row_open"),jQuery(".mess_content, .mess_reply_form").hide(),jQuery(this).parent().find(".mess_content").show();var r=jQuery("#wpestate_inbox_actions").val();jQuery.ajax({type:"POST",url:t,data:{action:"wpestate_booking_mark_as_read",messid:e,security:r},success:function(e){a.find(".mess_unread").remove()},error:function(e){}})})}function wpestate_enable_send_replay_button(){jQuery(".mess_send_reply_button").on("click",function(e){var t,a,r,i,s,n,_,d;a=dashboard_vars.admin_url+"admin-ajax.php",i=jQuery(this).parent().parent(),d=i.find(".mess_content"),_=jQuery(this).parent(),t=i.attr("data-messid"),r=jQuery(this),s=i.find(".subject_reply").val(),n=i.find(".message_reply_content").val(),i.find(".mess_unread").remove(),r.text(dashboard_vars.sending);var o=jQuery("#wpestate_inbox_actions").val();jQuery.ajax({type:"POST",url:a,data:{action:"wpestate_message_reply",messid:t,title:s,content:n,security:o},success:function(e){d.hide(),_.hide()},error:function(e){}})})}function wpestate_enable_stripe_recurring(){jQuery("#pack_recuring").on("click",function(e){jQuery(this).attr("checked")?jQuery("#stripe_form").append('<input type="hidden" name="stripe_recuring" id="stripe_recuring" value="1">'):jQuery("#stripe_recuring").remove()})}function wpestate_start_direct_pay(){jQuery("#direct_pay").on("click",function(e){var t,a,r;jQuery(".package_selected .pack-listing-title").text(),a=jQuery(".package_selected .pack-listing-title").attr("data-packid"),r=jQuery(".package_selected .pack-listing-title").attr("data-packprice"),r="after"===control_vars.where_curency?r+" "+control_vars.submission_curency:control_vars.submission_curency+" "+r,r=control_vars.direct_price+": "+r,""!==a&&(window.scrollTo(0,0),t='<div class="modal fade" id="direct_pay_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+control_vars.direct_title+'</h4><div class="modal-body listing-submit"><span class="to_be_paid">'+r+"</span><span>"+control_vars.direct_pay+'</span><div id="send_direct_bill" data-pack="'+a+'">'+control_vars.send_invoice+"</div></div></div></div></div></div>",jQuery("body").append(t),jQuery("#direct_pay_modal").modal(),wpestate_enable_direct_pay()),jQuery("#direct_pay_modal").on("hidden.bs.modal",function(e){jQuery("#direct_pay_modal").remove()})})}function wpestate_start_direct_paypment_per_listing(){jQuery(".perpack").on("click",function(e){var t,a,r,i;a=jQuery(this).attr("data-listing");var s=jQuery(this).attr("data-price-submission");s="after"===control_vars.where_curency?s+" "+control_vars.submission_curency:control_vars.submission_curency+" "+s,s=control_vars.direct_price+": "+s,r=' data-include-feat="0" ',jQuery("#send_direct_bill").attr("data-include-feat",0),jQuery("#send_direct_bill").attr("data-listing",a),jQuery(this).parent().find(".extra_featured").attr("checked")&&(r=' data-include-feat="1" ',jQuery("#send_direct_bill").attr("data-include-feat",1)),i=jQuery(this).attr("data-isupgrade"),void 0!==i&&!1!==i&&(r=' data-include-feat="1" ',jQuery("#send_direct_bill").attr("data-include-feat",1)),window.scrollTo(0,0),t='<div class="modal fade" id="direct_pay_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+control_vars.direct_title+'</h4><div class="modal-body listing-submit"><span class="to_be_paid">'+s+"</span><span>"+control_vars.direct_pay+'</span><div id="send_direct_bill" '+r+' data-listing="'+a+'">'+control_vars.send_invoice+"</div></div></div></div></div></div>",jQuery("body").append(t),jQuery("#direct_pay_modal").modal(),wpestate_enable_direct_pay_perlisting(),jQuery("#direct_pay_modal").on("hidden.bs.modal",function(e){jQuery("#direct_pay_modal").remove()})})}function wpestate_enable_direct_pay_perlisting(){jQuery("#send_direct_bill").unbind("click"),jQuery("#send_direct_bill").on("click",function(e){var t,a,r;jQuery("#send_direct_bill").unbind("click"),t=jQuery(this).attr("data-listing"),r=jQuery(this).attr("data-include-feat"),a=ajaxcalls_vars.admin_url+"admin-ajax.php",jQuery(".paymentmodal").hide();var i=jQuery("#wpresidence_simple_pay_actions_nonce").val();jQuery.ajax({type:"POST",url:a,data:{action:"wpestate_direct_pay_pack_per_listing",selected_pack:t,include_feat:r,security:i},success:function(e){jQuery("#send_direct_bill").hide(),jQuery("#direct_pay_modal .listing-submit span:nth-child(2)").empty().html(dashboard_vars.direct_thx)},error:function(e){}})})}function wpestate_enable_direct_pay(){jQuery("#send_direct_bill").on("click",function(e){var t,a;jQuery("#send_direct_bill").unbind("click"),t=jQuery(this).attr("data-pack"),a=ajaxcalls_vars.admin_url+"admin-ajax.php";var r=jQuery("#wpresidence_simple_pay_actions_nonce").val();jQuery.ajax({type:"POST",url:a,data:{action:"wpestate_direct_pay_pack",selected_pack:t,security:r},success:function(e){jQuery("#send_direct_bill").hide(),jQuery("#direct_pay_modal .listing-submit span:nth-child(2)").empty().html(dashboard_vars.direct_thx)},error:function(e){}})})}jQuery(document).ready(function(){"use strict";wpestate_start_direct_pay(),wpestate_start_direct_paypment_per_listing(),wpestate_enable_direct_pay(),wpestate_enable_direct_pay_perlisting(),wpestate_enable_stripe_recurring(),wpestate_start_pay_via_woo(),wpestate_close_stripe_form(),wpestate_enable_stripe_booking_prop(),wpestate_enable_send_replay_button(),wpestate_mark_message_as_read(),wpestate_message_replay_inbox(),wpestate_message_replay_inbox_2(),wpestate_message_delete_inbox()});