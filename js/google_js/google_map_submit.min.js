var geocoder,map,selected_id="",gmarkers=[],propertyMarker_submit="";function google_map_submit_initialize(){"use strict";if(0!==jQuery("#googleMapsubmit").length){var listing_lat=jQuery("#property_latitude").val(),listing_lon=jQuery("#property_longitude").val();if(jQuery("#agency_lat").length>0&&(listing_lat=jQuery("#agency_lat").val(),listing_lon=jQuery("#agency_long").val()),jQuery("#developer_lat").length>0&&(listing_lat=jQuery("#developer_lat").val(),listing_lon=jQuery("#developer_long").val()),""!==listing_lat&&void 0!==listing_lat||(listing_lat=google_map_submit_vars.general_latitude),""!==listing_lon&&void 0!==listing_lon||(listing_lon=google_map_submit_vars.general_longitude),1==parseInt(mapfunctions_vars.geolocation_type)){geocoder=new google.maps.Geocoder;var mapOptions={flat:!1,noClear:!1,zoom:17,scrollwheel:!1,draggable:!0,disableDefaultUI:!1,center:new google.maps.LatLng(listing_lat,listing_lon),mapTypeId:google.maps.MapTypeId.ROADMAP,gestureHandling:"cooperative"},point;if(!document.getElementById("googleMapsubmit"))return;if(map=new google.maps.Map(document.getElementById("googleMapsubmit"),mapOptions),google.maps.visualRefresh=!0,wpestate_placeSavedMarker(new google.maps.LatLng(listing_lat,listing_lon)),""!==mapfunctions_vars.map_style){var styles=JSON.parse(mapfunctions_vars.map_style);map.setOptions({styles:styles})}google.maps.event.addListener(map,"click",(function(event){wpestate_placeMarker(event.latLng)}))}else{var mapCenter=L.latLng(listing_lat,listing_lon);map=L.map("googleMapsubmit",{center:mapCenter,zoom:15});var tileLayer=wpresidence_open_stret_tile_details();map.addLayer(tileLayer),map.on("click",(function(e){map.removeLayer(propertyMarker_submit);var markerCenter=L.latLng(e.latlng);(propertyMarker_submit=L.marker(e.latlng).addTo(map)).bindPopup('<div class="submit_leaflet_admin">Latitude: '+e.latlng.lat+" Longitude: "+e.latlng.lng+"</div>").openPopup(),jQuery("#property_latitude").val(e.latlng.lat),jQuery("#property_longitude").val(e.latlng.lng),jQuery("#agency_lat").val(e.latlng.lat),jQuery("#agency_long").val(e.latlng.lng),jQuery("#developer_lat").val(e.latlng.lat),jQuery("#developer_long").val(e.latlng.lng)}));var markerCenter=L.latLng(mapCenter);(propertyMarker_submit=L.marker(markerCenter).addTo(map)).bindPopup('<div class="submit_leaflet_admin">Latitude: '+listing_lat+" Longitude: "+listing_lon+"</div>")}}}function wpestate_placeSavedMarker(location){"use strict";wpestate_removeMarkers();var marker=new google.maps.Marker({position:location,map:map}),infowindow;gmarkers.push(marker),new google.maps.InfoWindow({content:"Latitude: "+location.lat()+"<br>Longitude: "+location.lng()}).open(map,marker)}function wpestate_codeAddress(){"use strict";var address=document.getElementById("property_address").value,city=jQuery("#property_city_submit").val(),full_addr=address,listing_lat,listing_long;"none"!==city&&(full_addr=full_addr+","+city);var state=document.getElementById("property_county").value;state&&(full_addr=full_addr+","+state);var country=document.getElementById("property_country").value;if(country&&(full_addr=full_addr+","+country),1==parseInt(mapfunctions_vars.geolocation_type))geocoder.geocode({address:full_addr},(function(results,status){status==google.maps.GeocoderStatus.OK?(listing_lat=results[0].geometry.location.lat(),listing_long=results[0].geometry.location.lng(),wpresidence_submit_set_postion(listing_lat,listing_long)):alert(google_map_submit_vars.geo_fails+status)}));else if(2==parseInt(mapfunctions_vars.geolocation_type))var jqxhr=jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",addressdetails:"1",q:full_addr}).done((function(data){""==data?alert(google_map_submit_vars.geo_fails+status):(listing_lat=data[0].lat,listing_long=data[0].lon,wpresidence_submit_set_postion(listing_lat,listing_long))})).fail((function(data){})).always((function(){}))}function wpresidence_submit_set_postion(listing_lat,listing_long){if(wpestate_removeMarkers(),1==parseInt(mapfunctions_vars.geolocation_type)){var myLatLng=new google.maps.LatLng(listing_lat,listing_long);map.setCenter(myLatLng);var marker=new google.maps.Marker({map:map,position:myLatLng}),infowindow;gmarkers.push(marker),new google.maps.InfoWindow({content:"Latitude: "+listing_lat+"<br>Longitude: "+listing_long}).open(map,marker),document.getElementById("property_latitude").value=listing_lat,document.getElementById("property_longitude").value=listing_long}else{var mapCenter=L.latLng(listing_lat,listing_long),markerCenter=L.latLng(mapCenter);map.removeLayer(propertyMarker_submit),(propertyMarker_submit=L.marker(markerCenter).addTo(map)).bindPopup('<div class="submit_leaflet_admin">Latitude: '+listing_lat+" Longitude: "+listing_long+"</div>"),setTimeout((function(){propertyMarker_submit.openPopup()}),600),propertyMarker_submit.fire("click"),document.getElementById("property_latitude").value=listing_lat,document.getElementById("property_longitude").value=listing_long,map.panTo(new L.LatLng(listing_lat,listing_long))}}function wpestate_codeAddress_agency(agency_adress,agency_city,agency_county,agency_lat,agency_long){"use strict";var address=jQuery(agency_adress).val(),city=jQuery(agency_city).val(),full_addr=address+","+city,state=jQuery(agency_county).val(),open_street_address="";if(state&&(full_addr=full_addr+","+state),open_street_address=address+","+city,1==wp_estate_kind_of_map)geocoder.geocode({address:full_addr},(function(results,status){if(status==google.maps.GeocoderStatus.OK){map.setCenter(results[0].geometry.location);var marker=new google.maps.Marker({map:map,position:results[0].geometry.location}),infowindow;gmarkers.push(marker),new google.maps.InfoWindow({content:"Latitude: "+results[0].geometry.location.lat()+"<br>Longitude: "+results[0].geometry.location.lng()}).open(map,marker),jQuery(agency_lat).val(results[0].geometry.location.lat()),jQuery(agency_long).val(results[0].geometry.location.lng())}else alert(google_map_submit_vars.geo_fails+status)}));else if(2==wp_estate_kind_of_map)var jqxhr=jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",addressdetails:"1",q:open_street_address}).done((function(data){if(void 0!==data[0]){var listing_lat=data[0].lat,listing_long=data[0].lon,mapCenter=L.latLng(listing_lat,listing_long),markerCenter=L.latLng(mapCenter);map.removeLayer(propertyMarker_submit),(propertyMarker_submit=L.marker(markerCenter).addTo(map)).bindPopup('<div class="submit_leaflet_admin">Latitude: '+listing_lat+" Longitude: "+listing_long+"</div>"),setTimeout((function(){propertyMarker_submit.openPopup()}),600),map.panTo(new L.LatLng(listing_lat,listing_long)),jQuery(agency_lat).val(data[0].lat),jQuery(agency_long).val(data[0].lon)}else alert(google_map_submit_vars.geo_fails+status)})).fail((function(){})).always((function(){}))}function wpestate_placeMarker(location){"use strict";wpestate_removeMarkers();var marker=new google.maps.Marker({position:location,map:map}),infowindow,myElem;gmarkers.push(marker),new google.maps.InfoWindow({content:"Latitude: "+location.lat()+"<br>Longitude: "+location.lng()}).open(map,marker),null!==(myElem=document.getElementById("property_latitude"))&&(document.getElementById("property_latitude").value=location.lat(),document.getElementById("property_longitude").value=location.lng()),null!==(myElem=document.getElementById("agency_lat"))&&(document.getElementById("agency_lat").value=location.lat(),document.getElementById("agency_long").value=location.lng()),null!==(myElem=document.getElementById("developer_lat"))&&(document.getElementById("developer_lat").value=location.lat(),document.getElementById("developer_long").value=location.lng())}function wpestate_removeMarkers(){"use strict";for(var i=0;i<gmarkers.length;i++)1==parseInt(mapfunctions_vars.geolocation_type)?gmarkers[i].setMap(null):map.removeLayer(gmarkers[i])}jQuery("#open_google_submit").on("click",(function(){"use strict";setTimeout((function(){initialize(),google.maps.event.trigger(map,"resize")}),300)})),jQuery("#google_capture").on("click",(function(event){"use strict";event.preventDefault(),wpestate_removeMarkers(),wpestate_codeAddress()})),"object"==typeof google&&"object"==typeof google.maps?google.maps.event.addDomListener(window,"load",google_map_submit_initialize):google_map_submit_initialize(),jQuery("#google_agency_location").on("click",(function(event){"use strict";event.preventDefault(),wpestate_removeMarkers(),wpestate_codeAddress_agency("#agency_address","#agency_city","#agency_county","#agency_lat","#agency_long")})),jQuery("#google_developer_location").on("click",(function(event){"use strict";event.preventDefault(),wpestate_removeMarkers(),wpestate_codeAddress_agency("#developer_address","#developer_city","#developer_county","#developer_lat","#developer_long")})),jQuery(document).ready((function($){"use strict";var autocomplete,autocomplete2;$("#imagelist").sortable({revert:!0,update:function(event,ui){var all_id,new_id;all_id="",$("#imagelist .uploaded_images").each((function(){void 0!==(new_id=$(this).attr("data-imageid"))&&(all_id=all_id+","+new_id)})),$("#attachid").val(all_id)}});var options_types=["(cities)"],componentForm={establishment:"long_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"long_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name",postal_code_prefix:"short_name",neighborhood:"long_name"};if("yes"===google_map_submit_vars.enable_auto&&document.getElementById("property_address"))if(1==parseInt(mapfunctions_vars.geolocation_type)){autocomplete=new google.maps.places.Autocomplete(document.getElementById("property_address"),{types:["geocode"],partial_match:!0}),"yes"===google_map_submit_vars.limit_country&&autocomplete.setComponentRestrictions({country:[google_map_submit_vars.limit_country_select]});var input=document.getElementById("property_address");google.maps.event.addDomListener(input,"keydown",(function(e){13==e.keyCode&&(e.stopPropagation(),e.preventDefault())})),google.maps.event.addListener(autocomplete,"place_changed",(function(event){var place;wpestate_fillInAddress(autocomplete.getPlace())})),autocomplete2=new google.maps.places.Autocomplete(document.getElementById("property_city_submit"),{types:["(cities)"]}),google.maps.event.addListener(autocomplete2,"place_changed",(function(){var place;wpestate_fillInAddress(autocomplete2.getPlace())}))}else 2==parseInt(mapfunctions_vars.geolocation_type)&&jQuery("#property_address").autocomplete({source:function(request,response){var search_parameters={format:"json",q:request.term};"yes"===google_map_submit_vars.limit_country&&(search_parameters.countrycodes=google_map_submit_vars.limit_country_select),jQuery.get("https://nominatim.openstreetmap.org/search",search_parameters,(function(result){result.length?response(result.map((function(place){var return_obj={label:place.display_name,latitude:place.lat,longitude:place.lon,value:place.display_name};return void 0!==place.address&&(return_obj.county=place.address.county),void 0!==place.address&&(return_obj.city=place.address.city),void 0!==place.address&&(return_obj.state=place.address.state),void 0!==place.address&&(return_obj.country=place.address.country),void 0!==place.address&&(return_obj.zip=place.address.postcode),return_obj}))):response([{value:"",label:control_vars.geo_no_results}])}),"json")},select:function(event,ui){var listing_lat=ui.item.latitude,listing_long=ui.item.longitude;$("#property_zip").val(ui.item.zip),$("#property_county").val(ui.item.county),$("#property_city_submit").val(ui.item.city),$("#property_country").val(ui.item.country),$("#property_city_submit").val(ui.item.city),wpresidence_submit_set_postion(listing_lat,listing_long)}});function wpestate_fillInAddress(place){$("#property_area").val(""),$("#property_zip").val(""),$("#property_county").val(""),$("#property_city_submit").val("");for(var i=0;i<place.address_components.length;i++){var addressType=place.address_components[i].types[0],temp="",val=place.address_components[i][componentForm[addressType]];"street_number"===addressType||"route"===addressType||("neighborhood"===addressType?$("#property_area").val(val):"postal_code_prefix"===addressType?$("#property_zip").val(val):"postal_code"===addressType?$("#property_zip").val(val):"administrative_area_level_2"===addressType?$("#property_county").val(val):"administrative_area_level_1"===addressType?$("#property_county").val(val):"locality"===addressType?$("#property_city_submit").val(val):"country"===addressType&&$("#property_country").val(val))}wpestate_codeAddress()}function wpestate_codeAddress_child(){var address,city,full_addr=document.getElementById("property_address").value+","+jQuery("#property_city_submit").val();if(document.getElementById("property_state")){var state=document.getElementById("property_state").value;state&&(full_addr=full_addr+","+state)}if(document.getElementById("property_country")){var country=document.getElementById("property_country").value;country&&(full_addr=full_addr+","+country)}geocoder.geocode({address:full_addr},(function(results,status){if(status==google.maps.GeocoderStatus.OK){map.setCenter(results[0].geometry.location);var marker=new google.maps.Marker({map:map,position:results[0].geometry.location}),infowindow;new google.maps.InfoWindow({content:"Latitude: "+results[0].geometry.location.lat()+"<br>Longitude: "+results[0].geometry.location.lng()}).open(map,marker),document.getElementById("property_latitude").value=results[0].geometry.location.lat(),document.getElementById("property_longitude").value=results[0].geometry.location.lng()}else alert(google_map_submit_vars.geo_fails+status)}))}jQuery("#google_capture2").on("click",(function(event){event.preventDefault(),wpestate_codeAddress_child()}))}));